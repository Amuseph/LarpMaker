<%= provide(:title, 'My Events') %>
<div class="container col-11">
<div class="pagetitle">Event List</div>
<div class="pagesubtitle" >A List of All Attended Events</div>

<table class="table table-hover table-bordered table-sm">
 <thead class="thead-dark">
  <tr>
      <th>Name</th>
      <th>Description</th>
      <th>Start Date</th>
      <th>End Date</th>
      <th>Cabin</th>
      <th>Meal Plan</th>
      <th>Feedback</th>
  </tr>
  </thead>
  <tbody>
    <% @character.events.order('startdate desc').each do |event| %>
      <tr class="table-light">
        <td>
          <%= event.name %>
        </td>
        <td><%= event.description %></td>
        <td><%= event.startdate %></td>
        <td><%= event.enddate %></td>
        <td>
          <%= 
            if event.eventattendances.find_by(user_id: current_user).cabin.present?
              link_to event.eventattendances.find_by(user_id: current_user).cabin.name , event_path(event.id)
            else
              if event.startdate > Date.today
                link_to 'None - Update Today!', event_path(event.id)
              else
                'None'
              end
            end
          %>
        </td>
        <td><%= get_mealplan_link(event) %> </td>
        <td><%= get_feedback_link(event) %> </td>
      </tr>
    <% end %>
  </tbody>
</table>
